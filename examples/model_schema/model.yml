domain:
    cls: SedimentDBLDomain
    init_params:
        cell_size: !unit 100 mum
        sediment_length: !unit mm
        dbl_length: !unit 1 mm
        porosity: 0.6


environment:

    chemicals:

        oxy:
            cls: Variable
            init_params:
                name: oxy
                create:
                    hasOld: true
                    value: !unit 0.0 mol/l

                constraints:
                    top: !unit 0.2e-3 mol/l
                    bottom: !unit 0 mol/l

        h2s:
            cls: Variable
            init_params:
                name: h2s
                create:
                    hasOld: true
                    value: !unit 0.0 mol/l

                constraints:
                    top: !unit 0.0 mol/l
                    bottom: !unit 1e-3 mol/l

        n20:
            cls: Variable
            init_params:
                name: N20
                create:
                    value: 30



    irradiance:
        cls: Irradiance
        init_params:
            hours_total: 25.3
            day_fraction: 0.3

        channels:
            - name: par
              k0: !unit 15.3 1/cm
              k_mods:
                - [cyano, 6523]
                - [cyano, 65253]
                - [cyano, !unit 125 g/mm**3]

    processes:

        abiotic_h2s_oxidation:
            cls: ExprProcess
            init_params:
                formula: porosity * k * oxy**2 * h2s
                varnames: ['oxy', 'h2s', 'porosity']
                params:
                    k: !unit '70 1/((10**-3)*mol/l)**2/h'


microbes:
    cyano:
        cls: MicrobialGroup
        init_params:
            name: cyano

    processes:
        cls: ExprProcess

    init_params:
        formula: Qmax * biomass
        varnames:
            - biomass
        params:
            Qmax: !unit "0.00841 mol/g/h"

        responses:
            optimum(par):
                cls: ExprProcess
                init_params:
                    formula: optimum_response(par, Ks, Ki)
                    varnames:
                        - par
                    params:
                        Ks: 1
                        Ki: 10

            optimum(oxy):
                cls: ExprProcess
                init_params:
                    formula: optimum_response(oxy, Ks, Ki)
                    varnames:
                        - oxy
                    params:
                        Ks: !unit "0.3e-3 mol/l"
                        Ki: !unit "0.35e-3 mol/l"

formulae:
    optimum_response:
        variables: [x, Ks, Ki]
        expr: x/(x + Ks)/(1 + x/Ki)

